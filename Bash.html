<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>POSIX Shells</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>POSIX Shells</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_standard_input_output">Standard input/output</h2>
<div class="sectionbody">
<div class="paragraph"><p>A process uses file descriptors to read and write data from files
or other processes. Input, output and errors of each process are
handled by file descriptors.
A file descriptor is just a number that represents a stream of process data.
The file descriptors can be used to redirect data to other processes.
The POSIX commands are read/write and open.
Each process has three standard file descriptors:
0 - standard input (stdin)
1 - standard output (stdout)
2 - standard error (stderr)</p></div>
<div class="paragraph"><p>Pipes are pair of file descriptors for unidirectional data channels.
They connect the output of a process to the input of another process.
A pipe can only connect a output file discriptor to a input file descriptor.
Example: The pipe connects stdout of date process with stdin of dd process.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>        date <span style="color: #993399">1</span><span style="color: #990000">&gt;&amp;</span><span style="color: #993399">1</span> <span style="color: #990000">|</span> <span style="color: #993399">0</span><span style="color: #990000">&lt;&amp;</span><span style="color: #993399">0</span> dd</tt></pre></div></div>
<div class="paragraph"><p>The same example can be written as</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>        date <span style="color: #990000">|</span> dd</tt></pre></div></div>
<div class="paragraph"><p>Child processes copy file descriptors of their parent process.
The POSIX commands are pipe(2) and dup(2).</p></div>
<div class="paragraph"><p>Type of file descriptors are determined by their source.
If this is ambiguous the less than or greater than define the direction.
Both examples are equal redirection of stderr to stdout
The parenthesis create subshells so that the redirection to stops
after the process is finished.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">(</span> <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">2</span><span style="color: #990000">&gt;&amp;</span><span style="color: #993399">1</span> <span style="color: #990000">)</span>
<span style="color: #990000">(</span> <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">2</span><span style="color: #990000">&lt;&amp;</span><span style="color: #993399">1</span> <span style="color: #990000">)</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_redirection">Redirection</h2>
<div class="sectionbody">
<div class="paragraph"><p>The file descriptors can be used to redirect data to other processes.
Child processes copy file descriptors of their parent process.
The POSIX commands are pipe(2) and dup(2).</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_named_pipe_or_fifo">Named pipe or fifo</h2>
<div class="sectionbody">
<div class="paragraph"><p>A pipe connects two process stdin and stdout.
The POSIX commands are pipe and dup.
A unnamed pipe connects two process stdin and stdout.
The pipe is unidirectional one process sends data and
another process receices data.
Fifos are named pipes which are unidirectional.
A pipe with a fifo works like a network sockets.
Two dd processes can be connected with a pipe and fifo.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>      -----&lt; fifo &lt;-----
      v                 ^
      dd                 dd
      v                 ^
      -----&gt; pipe &gt;----</tt></pre></div></div>
<div class="paragraph"><p>In the next example two dd process connected with each other.
It is a quite useless but working example in the shell.
The commands are included in a here document as standard input of bash.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        mkfifo fifo
        <span style="color: #990000">&lt;</span>fifo dd <span style="color: #990000">|</span> dd <span style="color: #990000">&gt;</span>fifo
EOF</tt></pre></div></div>
<div class="paragraph"><p>Another example is on <a href="http://en.wikipedia.org/wiki/Netcat">http://en.wikipedia.org/wiki/Netcat</a>.
Two netcat processes redirect data from a webserver to localhost.
One process listens on localhost:12345 and sends data to webserver:80.
The other process receives data from the webserver.</p></div>
<div class="paragraph"><p>Besides fifo there are other ways to connect output with input filedescriptors. Bash coproc can replace fifo and in yash shell there is operator &gt;&gt;| for pipeline redirection. Another shell can be invoked from bash with input from a here document.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>yash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">3</span><span style="color: #990000">&gt;&gt;|</span><span style="color: #993399">4</span>
        <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">4</span> dd <span style="color: #990000">|</span> dd <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">3</span>
EOF</tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_here_documents">Here documents</h2>
<div class="sectionbody">
<div class="paragraph"><p>Here documents are connected to file descriptors in a script.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #993399">0</span><span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'BASH'</span> <span style="color: #990000">\</span>
<span style="color: #993399">3</span><span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'CAT'</span> <span style="color: #990000">\</span>
<span style="color: #993399">4</span><span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'TEXT'</span> <span style="color: #990000">\</span>
bash
        bash -s <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">3</span> <span style="color: #993399">4</span>
BASH
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #990000">&lt;&amp;</span><span style="color: #009900">$1</span>
        cat
CAT
        text
TEXT</tt></pre></div></div>
<div class="paragraph"><p>The nect example uses a here document in bash script with perl</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">#!/bin/bash</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># https://perldoc.perl.org/open.html</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">while</span></span> <span style="font-weight: bold"><span style="color: #0000FF">read</span></span> -d $<span style="color: #FF0000">'</span><span style="color: #CC33CC">\0</span><span style="color: #FF0000">'</span> <span style="color: #990000">||</span> <span style="color: #009900">EOF</span><span style="color: #990000">=</span><span style="color: #009900">$?</span> <span style="color: #990000">&amp;&amp;</span> <span style="color: #990000">[[</span> <span style="color: #009900">$REPLY</span> <span style="color: #990000">]]</span>
<span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        <span style="color: #990000">&lt;&lt;&lt;</span><span style="color: #009900">$REPLY</span> makeref <span style="color: #993399">2</span><span style="color: #990000">&gt;&amp;</span>- <span style="color: #990000">|</span> w3m -dump
        <span style="color: #990000">[[</span> <span style="color: #990000">!</span> <span style="color: #009900">$eof</span> <span style="color: #990000">]]</span> <span style="color: #990000">&amp;&amp;</span> <span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #990000">\\</span>x0C<span style="color: #990000">\\</span>x0A
<span style="font-weight: bold"><span style="color: #0000FF">done</span></span> <span style="color: #990000">&lt;</span> <span style="color: #990000">&lt;(</span>
perl -- - <span style="color: #990000">\</span>
<span style="color: #990000">&lt;&lt;</span><span style="color: #FF0000">'PERL'</span> <span style="color: #009900">${BASH_ARGV[*]:${MAIL}}</span>
        use open <span style="color: #FF0000">':std'</span><span style="color: #990000">,</span> <span style="color: #FF0000">':utf8'</span><span style="color: #990000">;</span>
        use Mail<span style="color: #990000">::</span>Box<span style="color: #990000">::</span>Mbox<span style="color: #990000">;</span>
        print join <span style="color: #FF0000">"</span><span style="color: #CC33CC">\x</span><span style="color: #FF0000">00"</span><span style="color: #990000">,</span> <span style="color: #990000">\</span>
                map { <span style="color: #009900">$_</span>-<span style="color: #990000">&gt;</span>head-<span style="color: #990000">&gt;</span>get<span style="color: #990000">(</span><span style="color: #FF0000">'Date'</span><span style="color: #990000">)</span> <span style="color: #990000">.</span> <span style="color: #FF0000">"</span><span style="color: #CC33CC">\t</span><span style="color: #FF0000">"</span> <span style="color: #990000">.</span> <span style="color: #009900">$_</span>-<span style="color: #990000">&gt;</span>head-<span style="color: #990000">&gt;</span>get<span style="color: #990000">(</span><span style="color: #FF0000">'From'</span><span style="color: #990000">)</span> <span style="color: #990000">.</span> <span style="color: #FF0000">"</span><span style="color: #CC33CC">\r</span><span style="color: #FF0000">"</span> <span style="color: #990000">.</span> <span style="color: #990000">(</span><span style="color: #009900">$_</span>-<span style="color: #990000">&gt;</span>isMultipart <span style="color: #990000">?</span> <span style="color: #009900">$_</span>-<span style="color: #990000">&gt;</span>body-<span style="color: #990000">&gt;</span>part<span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">)</span> <span style="color: #990000">:</span> <span style="color: #009900">$_</span><span style="color: #990000">)</span>-<span style="color: #990000">&gt;</span>body-<span style="color: #990000">&gt;</span>decoded } Mail<span style="color: #990000">::</span>Box<span style="color: #990000">::</span>Mbox-<span style="color: #990000">&gt;</span>new<span style="color: #990000">(</span>
                        folder <span style="color: #990000">=&gt;</span> <span style="color: #FF0000">"$ARGV[0]"</span>
                <span style="color: #990000">)</span>-<span style="color: #990000">&gt;</span>messages<span style="color: #990000">;</span>
PERL
<span style="color: #990000">)</span></tt></pre></div></div>
<div class="sect2">
<h3 id="_gnu_bash">GNU Bash</h3>
<div class="paragraph"><p>This chapter is about Bash only features.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_process_substitution">Process substitution</h2>
<div class="sectionbody">
<div class="paragraph"><p>Process substitution is a convenient feature in bash.
The previous example with process substitution.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash <span style="color: #990000">&lt;(</span>echo cat<span style="color: #990000">)</span> <span style="color: #990000">&lt;&lt;&lt;</span>text</tt></pre></div></div>
<div class="paragraph"><p>Some examples with file descriptor and process substitution.
Educational example of file descriptor and process substitution
The example uses a subshell with input from a here document.
Educational example of file descriptor and process substitution</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">(</span>
        <span style="font-style: italic"><span style="color: #9A1900"># Create file descriptors through process substitution</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #990000">&gt;&amp;</span>-                   <span style="font-style: italic"><span style="color: #9A1900"># close stdout</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">3</span><span style="color: #990000">&gt;</span> <span style="color: #990000">&gt;(</span>tac <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">2</span><span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900"># output to stderr</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">4</span><span style="color: #990000">&lt;</span> <span style="color: #990000">&lt;(</span>date<span style="color: #990000">)</span>    <span style="font-style: italic"><span style="color: #9A1900"># input from date</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">5</span><span style="color: #990000">&lt;</span> <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">3</span><span style="color: #990000">)</span>   <span style="font-style: italic"><span style="color: #9A1900"># input sequence of numbers</span></span>

        <span style="font-style: italic"><span style="color: #9A1900"># Join all input streams and redirect to stderr</span></span>
        cat <span style="color: #990000">\</span>
                <span style="color: #990000">&lt;(</span>cat <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">4</span><span style="color: #990000">)</span> <span style="color: #990000">\</span>
                <span style="color: #990000">&lt;(</span>cat <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">5</span><span style="color: #990000">)</span> <span style="color: #990000">\</span>
                <span style="color: #990000">|</span> tee <span style="color: #990000">&gt;(</span>cat <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">3</span><span style="color: #990000">)</span> <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">3</span>
<span style="color: #990000">)</span></tt></pre></div></div>
<div class="paragraph"><p>There are examples to insert commands into a build environment with file descriptors.</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="Devuan.html">Devuan</a>
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_coprocess">Coprocess</h2>
<div class="sectionbody">
<div class="paragraph"><p>In Bash coproc returns a pair file descriptors for input and output
Similar to named pipes coproc command can be used to redirect data streams.
A coproc returns a pair of file descriptors for input and output.
This example uses file descriptors of coproc.
For closing the filedescriptor eval is required.
Otherwise there is error <em>exec: 60: not found</em>.
<a href="https://www.linuxjournal.com/content/bash-co-processes">https://www.linuxjournal.com/content/bash-co-processes</a></p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        coproc { tac <span style="color: #990000">;</span> }
        date <span style="color: #990000">&gt;&amp;</span><span style="color: #009900">${COPROC[1]}</span>
        <span style="font-weight: bold"><span style="color: #0000FF">eval</span></span> <span style="color: #FF0000">"exec ${COPROC[1]}&gt;&amp;-"</span>
        cat <span style="color: #990000">&lt;&amp;</span><span style="color: #009900">${COPROC[0]}</span>
EOF</tt></pre></div></div>
<div class="paragraph"><p>There are a some problems with bash&#8217;s coproc.
Array variables are not exported like filedescriptors.
This is in bash 4.4 (man bash | grep -A16 BUGS).</p></div>
<div class="paragraph"><p>This does not work because of the pipe between coproc and tee.
It returns <em>Bad file descriptor</em>.
.bad filedescriptor</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash -e <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'ERROR'</span>
        coproc BAD { head <span style="color: #990000">|</span> nl<span style="color: #990000">;</span> }
        date <span style="color: #990000">|</span> tee <span style="color: #990000">&gt;&amp;</span><span style="color: #009900">${BAD[1]}</span>
ERROR</tt></pre></div></div>
<div class="paragraph"><p>The bad file descriptor can be prevented with a compound command.
.compound command</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash -e <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'OK'</span>
        coproc { head <span style="color: #990000">|</span> nl<span style="color: #990000">;</span> }
        { date <span style="color: #990000">|</span> tee <span style="color: #990000">;</span> } <span style="color: #990000">&gt;&amp;</span><span style="color: #009900">${COPROC[1]}</span>
OK</tt></pre></div></div>
<div class="paragraph"><p>The file descriptors can be duplicated.
In this way they are exported and closing them is easier.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash -e <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        coproc { head <span style="color: #990000">|</span> nl<span style="color: #990000">;</span> }
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">3</span><span style="color: #990000">&lt;&amp;</span><span style="color: #009900">${COPROC[0]}</span>-
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">4</span><span style="color: #990000">&lt;&amp;</span><span style="color: #009900">${COPROC[1]}</span>-
        date <span style="color: #990000">|</span> tee <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">4</span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">4</span><span style="color: #990000">&gt;&amp;</span>-
EOF</tt></pre></div></div>
<div class="paragraph"><p>A problem with bash and coreutils is how to do a self join with data from
standard input. As mentioned earlier coproc is a method for pipeline redirection. This is not required by the Posix standard. A coproc can join two streams.
This requires coproc. At some point the input must be closed before reading the output. A second coproc is necessary to join two streams.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash -e <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        seq <span style="color: #993399">123</span> <span style="color: #990000">|</span> {
                coproc A { head <span style="color: #990000">|</span> nl<span style="color: #990000">;</span> }<span style="color: #990000">;</span>
                coproc B { tail <span style="color: #990000">|</span> nl<span style="color: #990000">;</span> }<span style="color: #990000">;</span>
                tee <span style="color: #990000">&gt;(</span>cat <span style="color: #990000">&gt;&amp;</span><span style="color: #009900">${A[1]}</span><span style="color: #990000">)</span> <span style="color: #990000">&gt;</span> <span style="color: #990000">&gt;(</span>cat <span style="color: #990000">&gt;&amp;</span><span style="color: #009900">${B[1]}</span><span style="color: #990000">);</span>
                <span style="font-weight: bold"><span style="color: #0000FF">eval</span></span> <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #FF0000">"${A[1]}&gt;&amp;- ${B[1]}&gt;&amp;-"</span><span style="color: #990000">;</span>
                join <span style="color: #990000">&lt;(</span>cat <span style="color: #990000">&lt;&amp;</span><span style="color: #009900">${A[0]}</span><span style="color: #990000">)</span> <span style="color: #990000">&lt;(</span>cat <span style="color: #990000">&lt;&amp;</span><span style="color: #009900">${B[0]}</span><span style="color: #990000">);</span>
        }
EOF</tt></pre></div></div>
<div class="paragraph"><p>A file output file discriptor can not connect to a input.  Joining the result
of different processes requires coproc or named pipes.  Coproc is not a
standard feature and there is a warning about multiple coproc in version
4.4 of bash.</p></div>
<div class="paragraph"><p>The coproc can be replaced with fifo or yash pipline redirection.
The yash shell has pipeline redirection.  Yash shell can be invoked from bash.
Yash shell has a &gt;&gt;| operator which creates a pipe in a similar way as coproc.
- <a href="https://unix.stackexchange.com/questions/86270/how-do-you-use-the-command-coproc-in-various-shells">https://unix.stackexchange.com/questions/86270/how-do-you-use-the-command-coproc-in-various-shells</a></p></div>
<div class="paragraph"><p>The two pipes (4&gt;&gt;|5 and 6&gt;&gt;|7) join head and tail of the input.
It creates two filedescriptor like the coproc bash.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> yash -c <span style="color: #FF0000">'exec bash 3&gt;&gt;|4'</span>
EOF</tt></pre></div></div>
<div class="paragraph"><p>Shells can be invoked with input from a here document.  The syntax of yash
process redirection is shorter than coproc.  Unfortunately yash can not process
substitution.
Example: Join head and tail with yash pipeline redirection.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>yash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'YASH'</span>
        seq <span style="color: #993399">123</span> <span style="color: #990000">|</span> {
                <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">3</span><span style="color: #990000">&lt;&amp;</span><span style="color: #993399">0</span> <span style="color: #993399">4</span><span style="color: #990000">&gt;&gt;|</span><span style="color: #993399">5</span> <span style="color: #993399">6</span><span style="color: #990000">&gt;&gt;|</span><span style="color: #993399">7</span>
                bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'BASH'</span>
                        tee <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">3</span> <span style="color: #990000">&gt;(</span>head <span style="color: #990000">|</span> nl <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">4</span><span style="color: #990000">)</span> <span style="color: #990000">&gt;</span> <span style="color: #990000">&gt;(</span>tail <span style="color: #990000">|</span> nl <span style="color: #990000">&gt;&amp;</span><span style="color: #993399">6</span><span style="color: #990000">)</span>
                        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> <span style="color: #993399">4</span><span style="color: #990000">&gt;&amp;</span>- <span style="color: #993399">6</span><span style="color: #990000">&gt;&amp;</span>-
                        join <span style="color: #990000">&lt;(</span>cat <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">5</span><span style="color: #990000">)</span> <span style="color: #990000">&lt;(</span>cat <span style="color: #990000">&lt;&amp;</span><span style="color: #993399">7</span><span style="color: #990000">)</span>
            ls /proc<span style="color: #990000">/</span><span style="color: #009900">$BASHPID</span>/fd
                BASH
        }
YASH</tt></pre></div></div>
<div class="paragraph"><p>The xargs and parallel programs can execute multiple process at same time.
Joining the result of different threads is difficult.
Execute bash command string return from parallel</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash -exc <span style="color: #FF0000">"$( cat &lt;&lt;-EOF</span>
<span style="color: #FF0000">        # wait for tmux terminal to start</span>
<span style="color: #FF0000">        sleep 3</span>
<span style="color: #FF0000">        # execute 6 parallel sleep processes in tmux</span>
<span style="color: #FF0000">        coproc {</span>
<span style="color: #FF0000">                # parallel starts tmux and returns a attach command</span>
<span style="color: #FF0000">                seq 6 | tac \</span>
<span style="color: #FF0000">                parallel --tmux --max-procs 4 sleep 2&gt;&amp;1 | \</span>
<span style="color: #FF0000">                head -n1 | \</span>
<span style="color: #FF0000">                cut -d: -f2</span>
<span style="color: #FF0000">        }</span>
<span style="color: #FF0000">        exec ${COPROC[1]}&gt;&amp;-</span>
<span style="color: #FF0000">        cat &lt;&amp;${COPROC[0]}</span>
<span style="color: #FF0000">        wait</span>
<span style="color: #FF0000">EOF</span>
<span style="color: #FF0000">)"</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_coreutils">Coreutils</h2>
<div class="sectionbody">
<div class="quoteblock">
<div class="content"><em>
 This package contains the basic file, shell and text manipulation
 utilities which are expected to exist on every operating system.
</em></div>
<div class="attribution">
&#8212; Debian
</div></div>
<div class="paragraph"><p>Many commands in coreutils are a tools for text processing.  All together they
are like the SQL of shell programming. The join command is one of the most
important commands in SQL and coreutils. There is no self join in coreutils.
In coreutils the joined columns is moved to the left. Empty values are equal.</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="https://www.gnu.org/software/coreutils/">https://www.gnu.org/software/coreutils/</a>
</p>
</li>
<li>
<p>
<a href="http://www.maizure.org/projects/decoded-gnu-coreutils/">http://www.maizure.org/projects/decoded-gnu-coreutils/</a>
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="title">join</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Column with two rows</span></span>
seq <span style="color: #993399">2</span>

<span style="font-style: italic"><span style="color: #9A1900"># Additional column with two rows</span></span>
seq <span style="color: #993399">2</span> <span style="color: #990000">|</span> nl

<span style="font-style: italic"><span style="color: #9A1900"># Inner join with three rows</span></span>
seq <span style="color: #993399">2</span> <span style="color: #990000">|</span> nl <span style="color: #990000">|</span> join - <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">3</span><span style="color: #990000">)</span>

<span style="font-style: italic"><span style="color: #9A1900"># Outer join with three rows</span></span>
seq <span style="color: #993399">2</span> <span style="color: #990000">|</span> nl <span style="color: #990000">|</span> join - <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">3</span><span style="color: #990000">)</span> -a<span style="color: #993399">2</span>

<span style="font-style: italic"><span style="color: #9A1900"># Cross join with the empty columns</span></span>
seq <span style="color: #993399">2</span> <span style="color: #990000">|</span> nl <span style="color: #990000">|</span> join - <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">3</span><span style="color: #990000">)</span> -j<span style="color: #993399">3</span>

<span style="font-style: italic"><span style="color: #9A1900"># Additional column with a cross join of a single row</span></span>
seq <span style="color: #993399">2</span> <span style="color: #990000">|</span> nl <span style="color: #990000">|</span> join - <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">1</span><span style="color: #990000">)</span> -j<span style="color: #993399">3</span></tt></pre></div></div>
<div class="paragraph"><p>A additonal key column can be added before ordering with the join program. In the example the key is used to sort the output of the tee process.
.join</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>seq <span style="color: #993399">6</span> <span style="color: #990000">|</span> sed s<span style="color: #990000">/^/\\\\</span>x4<span style="color: #990000">/</span> <span style="color: #990000">|</span> xargs -<span style="color: #993399">0</span> <span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #990000">%</span>b <span style="color: #990000">|</span> nl <span style="color: #990000">\</span>
        <span style="color: #990000">|</span> tee <span style="color: #990000">\</span>
                <span style="color: #990000">&gt;(</span>head -n<span style="color: #993399">4</span> <span style="color: #990000">|</span> join -j<span style="color: #993399">3</span> <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">1</span><span style="color: #990000">)</span> -<span style="color: #990000">)</span> <span style="color: #990000">\</span>
                        <span style="color: #990000">&gt;</span> <span style="color: #990000">\</span>
                <span style="color: #990000">&gt;(</span>tail -n<span style="color: #993399">4</span> <span style="color: #990000">|</span> join -j<span style="color: #993399">3</span> <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">2</span> <span style="color: #993399">2</span><span style="color: #990000">)</span> -<span style="color: #990000">)</span> <span style="color: #990000">\</span>
        <span style="color: #990000">|</span> sort -k<span style="color: #993399">2</span> <span style="color: #990000">|</span> join -<span style="color: #993399">11</span> -<span style="color: #993399">22</span> <span style="color: #990000">&lt;(</span>seq <span style="color: #993399">3</span> <span style="color: #993399">4</span><span style="color: #990000">)</span> -</tt></pre></div></div>
<div class="paragraph"><p>The join command moves the key column to the left. There is no easy way to
reorder columns with coreutils. With cut the order remains in the same order
that is read. This is where awk becomes a useful tool.
- <a href="https://lists.gnu.org/archive/html/bug-coreutils/2012-12/msg00117.html">https://lists.gnu.org/archive/html/bug-coreutils/2012-12/msg00117.html</a></p></div>
<div class="paragraph"><p>This example replaces column 2 with 0 where column 1 is not 0.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        paste <span style="color: #990000">&lt;(</span>
                echo $<span style="color: #FF0000">'a</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">0</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">b</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">0</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">c'</span>
        <span style="color: #990000">)</span> <span style="color: #990000">&lt;(</span>
                seq -<span style="color: #993399">5</span> -<span style="color: #993399">1</span>
        <span style="color: #990000">)</span> <span style="color: #990000">|</span> awk <span style="color: #FF0000">'{if($1) print $1,0; else print $1,$2} '</span>
EOF</tt></pre></div></div>
<div class="paragraph"><p>Typescript records the in and output of a terminal.
After recording the file can be replayed with scriptreplay.
The input from keybourd is wrong with a different file descriptor.
Please see man script | less +/^BUGS about issues with input redirection</p></div>
<div class="listingblock">
<div class="title">typescript</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>script <span style="color: #993399">3</span><span style="color: #990000">&lt;&amp;</span><span style="color: #993399">0</span> <span style="color: #993399">0</span><span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'SCRIPT'</span> -c <span style="color: #FF0000">"</span>
<span style="color: #FF0000">                exec bash &lt;&amp;0</span>
<span style="color: #FF0000">        "</span>
        date
        <span style="font-weight: bold"><span style="color: #0000FF">exec</span></span> bash <span style="color: #993399">0</span><span style="color: #990000">&lt;&amp;</span><span style="color: #993399">3</span>
SCRIPT</tt></pre></div></div>
<div class="paragraph"><p>The same example with grep and coreutils to sort the stdout of subprocesses.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        join <span style="color: #990000">&lt;(</span>
                join <span style="color: #990000">&lt;(</span>
                        paste <span style="color: #990000">&lt;(</span>
                                echo $<span style="color: #FF0000">'a</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">0</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">b</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">0</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">c'</span>
                        <span style="color: #990000">)</span> <span style="color: #990000">&lt;(</span>
                                seq -<span style="color: #993399">5</span> -<span style="color: #993399">1</span>
                        <span style="color: #990000">)</span> <span style="color: #990000">|</span> nl <span style="color: #990000">|</span> sort -k<span style="color: #993399">2</span>
                        <span style="color: #990000">)</span> <span style="color: #990000">&lt;(</span>
                                seq <span style="color: #993399">0</span> <span style="color: #993399">0</span> <span style="color: #990000">|</span> nl
                        <span style="color: #990000">)</span> -j<span style="color: #993399">2</span> -a<span style="color: #993399">1</span> <span style="color: #990000">|</span> sort -k<span style="color: #993399">4</span>
                <span style="color: #990000">)</span> <span style="color: #990000">&lt;(</span>
                        seq <span style="color: #993399">0</span> <span style="color: #993399">1</span>
                <span style="color: #990000">)</span> -e<span style="color: #993399">0</span> -<span style="color: #993399">21</span> -<span style="color: #993399">14</span> -a<span style="color: #993399">1</span> <span style="color: #990000">|</span> sort -k<span style="color: #993399">3</span> <span style="color: #990000">|</span> nl -nln <span style="color: #990000">|</span> tee <span style="color: #990000">&gt;(</span>
                        grep -P <span style="color: #990000">\\</span>t0 <span style="color: #990000">|</span> cut -d<span style="color: #990000">\</span>  -f<span style="color: #993399">1</span>- <span style="color: #990000">|</span> join - <span style="color: #990000">&lt;(</span>
                                seq <span style="color: #993399">0</span> <span style="color: #993399">0</span>
                        <span style="color: #990000">)</span> -j<span style="color: #993399">3</span> -a<span style="color: #993399">1</span> <span style="color: #990000">|</span> cut -d<span style="color: #990000">\</span>  -f<span style="color: #993399">1</span>-<span style="color: #993399">3</span>
                <span style="color: #990000">)</span> <span style="color: #990000">&gt;</span> <span style="color: #990000">&gt;(</span>
                        grep -P <span style="color: #990000">\\</span>t1 <span style="color: #990000">|</span> cut -d<span style="color: #990000">\</span>  -f<span style="color: #993399">1</span>- <span style="color: #990000">|</span> join - <span style="color: #990000">&lt;(</span>
                                seq <span style="color: #993399">0</span> <span style="color: #993399">0</span>
                        <span style="color: #990000">)</span> -j<span style="color: #993399">3</span> -a<span style="color: #993399">1</span> <span style="color: #990000">|</span> cut -d<span style="color: #990000">\</span>  -f<span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">2</span><span style="color: #990000">,</span><span style="color: #993399">5</span>
                <span style="color: #990000">)</span> <span style="color: #990000">|</span> sort -k<span style="color: #993399">2</span> <span style="color: #990000">|</span> cut -d<span style="color: #990000">\</span>  -f<span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">3</span>
EOF</tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_stream_editor_sed">Stream editor sed</h2>
<div class="sectionbody">
<div class="paragraph"><p>Streams can be manipulated with the sed command.
It is one of the simple but powerful commands.
info sed --index-search=<em>evaluate</em></p></div>
<div class="listingblock">
<div class="title">sed</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Pattern space and hold space, branches and evaluate.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># The exmple swaps every other line of the input.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># There are GNU specific commands like evaluate.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># It is not documented in the man page.</span></span>
seq <span style="color: #993399">8</span> <span style="color: #990000">|</span>
sed <span style="color: #FF0000">'1~2{h;d};0~2{G}'</span>
seq <span style="color: #993399">6</span>  <span style="color: #990000">|</span>
sed -e<span style="color: #FF0000">'s/^/seq /'</span> -e <span style="color: #FF0000">'s/$/ |</span>
<span style="color: #FF0000">paste -s/e'</span>
<span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #FF0000">' 1</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 2</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 3</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">4</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">5</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 6</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 7</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">'</span> <span style="color: #990000">|</span> sed <span style="color: #FF0000">'1s/^ //;:a;$!N;s/</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> / /;ta;P;D;'</span>

<span style="font-style: italic"><span style="color: #9A1900"># With sed monitor file and execute commands with sed</span></span>
stdbuf -o<span style="color: #993399">0</span> bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        tail -F fifo <span style="color: #990000">|</span> xxd -p -c<span style="color: #993399">1</span> <span style="color: #990000">|</span> sed s<span style="color: #990000">/.*</span>/date/e <span style="color: #990000">|</span> xargs -I@ <span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #990000">%</span>q<span style="color: #990000">\\</span>n @

<span style="font-style: italic"><span style="color: #9A1900"># info sed shows additional documentation</span></span>
info sed --index-search<span style="color: #990000">=</span><span style="color: #FF0000">'evaluate'</span></tt></pre></div></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># A process pipeline that greps upgrades from debian package log file:</span></span>
bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        cat /var/log/dpkg<span style="color: #990000">.</span>log{<span style="color: #990000">.</span><span style="color: #993399">1</span><span style="color: #990000">,</span>} <span style="color: #990000">|</span>
        grep -P <span style="color: #FF0000">'.{20}upgrade'</span> <span style="color: #990000">|</span>
        cut -d<span style="color: #FF0000">' '</span> -f<span style="color: #993399">4</span><span style="color: #990000">,</span><span style="color: #993399">5</span><span style="color: #990000">,</span><span style="color: #993399">7</span> <span style="color: #990000">|</span>
        sed <span style="color: #FF0000">'s/:/ /'</span> <span style="color: #990000">|</span>
        grep -o <span style="color: #FF0000">'[^[:space:]]*'</span> <span style="color: #990000">|</span>
        sed  -n -e <span style="color: #FF0000">'p;n;x;n;p;x;p;'</span> <span style="color: #990000">|</span>
        grep xserver -A<span style="color: #990000">+</span><span style="color: #993399">2</span> <span style="color: #990000">|</span>
        paste - - - -d_ <span style="color: #990000">|</span>
        xargs urlencode <span style="color: #990000">|</span>
        tr <span style="color: #FF0000">'[[:upper:]]'</span> <span style="color: #FF0000">'[[:lower:]]'</span> <span style="color: #990000">|</span>
        sed <span style="color: #FF0000">'s/$/.deb/'</span>
EOF</tt></pre></div></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># With sed monitor file and execute commands with sed</span></span>
stdbuf -o<span style="color: #993399">0</span> bash <span style="color: #990000">&lt;&lt;</span>-<span style="color: #FF0000">'EOF'</span>
        tail -F fifo <span style="color: #990000">|</span> xxd -p -c<span style="color: #993399">1</span> <span style="color: #990000">|</span> sed s<span style="color: #990000">/.*</span>/date/e <span style="color: #990000">|</span> xargs -I@ <span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #990000">%</span>q<span style="color: #990000">\\</span>n @
EOF</tt></pre></div></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Examples: Pattern space and hold space, branches and evaluate.</span></span>
seq <span style="color: #993399">8</span> <span style="color: #990000">|</span> sed <span style="color: #FF0000">'1~2{h;d};0~2{G}'</span>

sed P<span style="color: #990000">;</span>D commands
seq <span style="color: #993399">6</span>  <span style="color: #990000">|</span> sed <span style="color: #FF0000">'l;N;P;D'</span>
<span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #FF0000">' 1</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 2</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 3</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">4</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">5</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 6</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> 7</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">'</span> <span style="color: #990000">|</span> sed <span style="color: #FF0000">'1s/^ //;:a;$!N;s/</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000"> / /;ta;P;D;'</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_xargs">xargs</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Execute commands with xargs</span></span>
seq <span style="color: #993399">3</span> <span style="color: #990000">|</span> xargs -<span style="color: #993399">0</span> --arg-file <span style="color: #990000">&lt;(</span>yes <span style="color: #FF0000">"wc -l"</span> <span style="color: #990000">|</span> head<span style="color: #990000">)</span> bash -c
EOF</tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_escaping_interpretation_of_special_characters">Escaping interpretation of special characters</h2>
<div class="sectionbody">
<div class="paragraph"><p>The shell needs special characters to evaluate its commands.
The special characters need escaping to avoid shell interpretation.
Escaping is different depending where the special character occurs.
Backslash escape works everywhere but not inside single quotes.
In a single quoted word no special characters needs escaping.
A single quote can be escaped only with backslash or double quotes.
It is not possible to use a single quote inside single quotes.</p></div>
<div class="listingblock">
<div class="title">printf</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #990000">%</span>q<span style="color: #990000">\\</span>n echo<span style="color: #990000">\</span> <span style="color: #990000">\\</span>\'<span style="color: #990000">\\\\\\</span>\'<span style="color: #990000">\\</span>\' <span style="color: #990000">|</span> xargs bash -c
<span style="font-weight: bold"><span style="color: #0000FF">printf</span></span> <span style="color: #990000">%</span>q<span style="color: #990000">\\</span>n <span style="color: #FF0000">"echo </span><span style="color: #CC33CC">\"</span><span style="color: #FF0000">'</span><span style="color: #CC33CC">\\</span><span style="color: #FF0000">'</span><span style="color: #CC33CC">\"\\</span><span style="color: #FF0000">'"</span> <span style="color: #990000">|</span> xargs bash -c</tt></pre></div></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2019-01-28 12:24:27 CET
</div>
</div>
</body>
</html>
